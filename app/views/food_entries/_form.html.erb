<%= form_with(model: food_entry) do |form| %>
  <% if food_entry.errors.any? %>
    <div class="alert alert-danger">
      <h4>–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:</h4>
      <ul>
        <% food_entry.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- 1. –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ -->
  <div class="row mb-4">
    <div class="col-md-6 mb-3">
      <%= form.label :date_eaten, "–î–∞—Ç–∞", class: "fw-bold mb-2" %>
      <%= form.date_field :date_eaten, class: "form-control", value: Date.today %>
    </div>
    
    <div class="col-md-6 mb-3">
      <%= form.label :meal_type_id, "–ü—Ä–∏—ë–º –ø–∏—â–∏", class: "fw-bold mb-2" %>
      <%= form.collection_select :meal_type_id, MealType.all, :id, :name, {}, { class: "form-select" } %>
    </div>
  </div>

  <div class="card p-4 mb-4" style="background: #fffef0; border: 2px dashed black;">
    <h4 class="mb-3">ü•™ –ß—Ç–æ –∏–º–µ–Ω–Ω–æ —Å—ä–µ–ª–∏?</h4>
    
    <!-- 2. –í–ª–æ–∂–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ –¥–ª—è –ü–†–û–î–£–ö–¢–ê (fields_for) -->
    <%= form.fields_for :product do |product_form| %>
      
      <div class="mb-3">
        <%= product_form.label :name, "–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞", class: "fw-bold" %>
        <%= product_form.text_field :name, class: "form-control", placeholder: "–ù–∞–ø—Ä–∏–º–µ—Ä: –ë–æ—Ä—â –¥–æ–º–∞—à–Ω–∏–π" %>
      </div>

      <div class="mb-3">
        <%= product_form.label :food_category_id, "–ö–∞—Ç–µ–≥–æ—Ä–∏—è", class: "fw-bold" %>
        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—é –ª—É—á—à–µ –æ—Å—Ç–∞–≤–∏—Ç—å —Å–ø–∏—Å–∫–æ–º, —á—Ç–æ–±—ã –±–∞–∑–∞ –±—ã–ª–∞ —á–∏—â–µ -->
        <%= product_form.collection_select :food_category_id, FoodCategory.all, :id, :name, {}, { class: "form-select" } %>
      </div>

      <div class="row">
        <div class="col-6 col-md-3 mb-2">
          <%= product_form.label :calories, "–ö–∫–∞–ª (–Ω–∞ 100–≥)", class: "small fw-bold" %>
          <%= product_form.number_field :calories, class: "form-control" %>
        </div>
        <div class="col-6 col-md-3 mb-2">
          <%= product_form.label :proteins, "–ë–µ–ª–∫–∏ (–≥)", class: "small fw-bold" %>
          <%= product_form.number_field :proteins, step: 0.1, class: "form-control" %>
        </div>
        <div class="col-6 col-md-3 mb-2">
          <%= product_form.label :fats, "–ñ–∏—Ä—ã (–≥)", class: "small fw-bold" %>
          <%= product_form.number_field :fats, step: 0.1, class: "form-control" %>
        </div>
        <div class="col-6 col-md-3 mb-2">
          <%= product_form.label :carbs, "–£–≥–ª–µ–≤–æ–¥—ã (–≥)", class: "small fw-bold" %>
          <%= product_form.number_field :carbs, step: 0.1, class: "form-control" %>
        </div>
      </div>
    <% end %>
  </div>

  <!-- 3. –í–µ—Å –ø–æ—Ä—Ü–∏–∏ -->
  <div class="mb-4">
    <%= form.label :weight_grams, "–í–µ—Å –ø–æ—Ä—Ü–∏–∏ (–≥—Ä–∞–º–º)", class: "fw-bold mb-2" %>
    <%= form.number_field :weight_grams, class: "form-control form-control-lg", placeholder: "200" %>
  </div>

  <div>
    <%= form.submit "–î–æ–±–∞–≤–∏—Ç—å –≤ –¥–Ω–µ–≤–Ω–∏–∫", class: "btn-primary w-100 py-3" %>
  </div>
<% end %>
